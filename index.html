<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ERP UI - Home</title>

  <link rel="stylesheet" href="common.css">
<script defer src="common.js"></script>
</head>

<body>

<header class="topbar">
  <div class="topbar-inner">
    <div class="brand" onclick="location.href='index.html'">
      <div class="logo">◎</div>
      <div>ERP UI</div>
    </div>

    <nav>
  <div class="nav-item">정보관리
    <div class="dropdown">
      <a class="drop-item" href="biz_owner.html">사업자관리</a>
      <a class="drop-item" href="customer.html">고객관리</a>
      <a class="drop-item" href="am_goal.html">파트 및 어카운트매니저 목표 입력</a>
      <div class="drop-sep"></div>
      <a class="drop-item" href="order_list.html">주문목록</a>
      <a class="drop-item" href="order_create.html">주문등록</a>
      <a class="drop-item" href="order_special_list.html">별도사업주문목록</a>
      <a class="drop-item" href="outsourcing_po_create.html">외주발주등록</a>
    </div>
  </div>

  <div class="nav-item">매출관리
    <div class="dropdown">
      <a class="drop-item" href="sales_list.html">매출목록</a>
      <a class="drop-item" href="ship_done_list.html">발송완료목록</a>
      <a class="drop-item" href="card_sales_list.html">카드매출목록</a>
      <div class="drop-sep"></div>
      <a class="drop-item" href="pre_sales_list.html">선매출목록</a>
      <a class="drop-item" href="pre_sales_input.html">선매출입력</a>
      <div class="drop-sep"></div>
      <a class="drop-item" href="untact_order_create.html">비대면주문 등록</a>
      <a class="drop-item" href="untact_order_list.html">비대면주문 목록</a>
      <a class="drop-item" href="untact_settlement.html">비대면 정산</a>
      <div class="drop-sep"></div>
      <a class="drop-item" href="tax_issue.html">세금계산서발행</a>
      <a class="drop-item" href="tax_issue_manual.html">세금계산서수기발행</a>
      <a class="drop-item" href="tax_issue_list.html">세금계산서 발행목록</a>
    </div>
  </div>

  <div class="nav-item">매입마감
    <div class="dropdown">
      <a class="drop-item" href="outsourcing_settlement_create.html">외주정산등록</a>
      <a class="drop-item" href="outsourcing_settlement_status.html">외주정산현황</a>
      <a class="drop-item" href="purchase_invoice_input.html">구매송장입력</a>
    </div>
  </div>

  <div class="nav-item">통계
    <div class="dropdown">
      <a class="drop-item" href="stats_team_forecast.html">본부 및 팀 예상매출</a>
      <a class="drop-item" href="stats_team_goal_actual.html">본부 및 팀 매출목표 및 실적</a>
      <a class="drop-item" href="stats_part_goal_actual_yoy.html">팀 및 파트별 매출목표 및 실적(전년대비)</a>
      <a class="drop-item" href="stats_am_goal_actual_yoy.html">어카운트매니저 매출목표 및 실적(전년대비확인)</a>
      <div class="drop-sep"></div>
      <a class="drop-item" href="stats_item_perf.html">품목별 실적조회</a>
      <a class="drop-item" href="stats_vendor_margin.html">거래처별 외주 마진율확인</a>
      <a class="drop-item" href="stats_order_margin.html">주문건별 외주 마진율확인</a>
    </div>
  </div>
</nav>


    <div class="userbox">H.Q / 안현모</div>
  </div>
</header>

<main class="app">
  <section class="panel">
    <div class="panel-head">
      <div>
        <div class="panel-title">매출 추이 (최근 12개월)</div>
        <div class="panel-sub">샘플 데이터 · 홈 대시보드</div>
      </div>
    </div>

    <div class="panel-body">
      <canvas id="trendChart"></canvas>
    </div>
  </section>
</main>

<script>
  // ===== 샘플 데이터 =====
  const months = ["02","03","04","05","06","07","08","09","10","11","12","01"];
  const sales =  [68, 72, 70, 78, 81, 79, 88, 92, 95, 90, 98, 105]; 
  const target = [70, 70, 72, 75, 80, 82, 85, 90, 92, 95, 100, 102];

  function fitCanvasToCSS(canvas){
    const dpr = window.devicePixelRatio || 1;
    const rect = canvas.getBoundingClientRect();
    canvas.width  = Math.round(rect.width  * dpr);
    canvas.height = Math.round(rect.height * dpr);
    const ctx = canvas.getContext("2d");
    ctx.setTransform(dpr,0,0,dpr,0,0);
    return ctx;
  }

  function drawTrend(canvas, labels, seriesA, seriesB){
    const ctx = fitCanvasToCSS(canvas);
    const w = canvas.getBoundingClientRect().width;
    const h = canvas.getBoundingClientRect().height;

    const P = { l:46, r:16, t:14, b:34 };
    const cw = w - P.l - P.r;
    const ch = h - P.t - P.b;

    const all = seriesA.concat(seriesB);
    const minV = Math.min(...all) * 0.9;
    const maxV = Math.max(...all) * 1.1;

    const x = (i) => P.l + (cw * i) / (labels.length - 1);
    const y = (v) => P.t + (ch * (maxV - v)) / (maxV - minV);

    ctx.clearRect(0,0,w,h);

    // Grid
    ctx.lineWidth = 1;
    ctx.strokeStyle = "#eef2f7";
    for(let g=0; g<=4; g++){
      const yy = P.t + (ch * g) / 4;
      ctx.beginPath();
      ctx.moveTo(P.l, yy);
      ctx.lineTo(P.l+cw, yy);
      ctx.stroke();
    }

    // Y labels
    ctx.fillStyle = "#6b7280";
    ctx.font = "12px system-ui";
    ctx.fillText(Math.round(maxV) + "00만", 6, P.t + 12);
    ctx.fillText(Math.round(minV) + "00만", 6, P.t + ch);

    // Target line (dashed)
    ctx.setLineDash([6,6]);
    ctx.strokeStyle = "rgba(31,111,178,.45)";
    ctx.lineWidth = 2;
    ctx.beginPath();
    seriesB.forEach((v,i)=> (i===0?ctx.moveTo(x(i),y(v)):ctx.lineTo(x(i),y(v))));
    ctx.stroke();
    ctx.setLineDash([]);

    // Sales line
    ctx.strokeStyle = "#2b7bbb";
    ctx.lineWidth = 3;
    ctx.beginPath();
    seriesA.forEach((v,i)=> (i===0?ctx.moveTo(x(i),y(v)):ctx.lineTo(x(i),y(v))));
    ctx.stroke();

    // Points
    ctx.fillStyle = "#2b7bbb";
    seriesA.forEach((v,i)=>{
      ctx.beginPath();
      ctx.arc(x(i), y(v), 4, 0, Math.PI*2);
      ctx.fill();
    });

    // X labels
    ctx.fillStyle = "#6b7280";
    ctx.font = "12px system-ui";
    labels.forEach((lab,i)=>{
      const xx = x(i);
      const yy = P.t + ch + 24;
      const tw = ctx.measureText(lab).width;
      ctx.fillText(lab, xx - tw/2, yy);
    });
  }

  function render(){
    drawTrend(document.getElementById("trendChart"), months, sales, target);
  }

  render();
  window.addEventListener("resize", render);
</script>

</body>
</html>
